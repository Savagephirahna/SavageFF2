-- SavageHub.lua
-- Place this LocalScript into StarterPlayerScripts in a Roblox Studio place you own.
-- Adds a simple on-screen "Savage Hub" menu to toggle Fly, adjust WalkSpeed and JumpPower.

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")

local player = Players.LocalPlayer

-- Wait for character
local function getCharacter()
	return player.Character or player.CharacterAdded:Wait()
end

local char = getCharacter()
local humanoid = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")
local camera = workspace.CurrentCamera

-- Default settings
local SavageHub = {
	Enabled = true,             -- master switch for HUD
	Fly = false,
	FlySpeed = 100,             -- studs per second
	WalkSpeed = humanoid.WalkSpeed or 16,
	JumpPower = humanoid.JumpPower or 50,
	MenuVisible = true,
	ToggleKey = Enum.KeyCode.RightShift, -- key to show/hide menu
}

-- UI builder
local function createUI()
	local screenGui = Instance.new("ScreenGui")
	screenGui.Name = "SavageHubGUI"
	screenGui.ResetOnSpawn = false
	screenGui.Parent = player:WaitForChild("PlayerGui")

	local main = Instance.new("Frame")
	main.Name = "Main"
	main.Size = UDim2.new(0, 260, 0, 220)
	main.Position = UDim2.new(0, 20, 0.5, -110)
	main.AnchorPoint = Vector2.new(0, 0.5)
	main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	main.BorderSizePixel = 0
	main.Parent = screenGui

	local title = Instance.new("TextLabel")
	title.Name = "Title"
	title.Size = UDim2.new(1, -12, 0, 36)
	title.Position = UDim2.new(0, 6, 0, 6)
	title.BackgroundTransparency = 1
	title.Text = "Savage Hub"
	title.Font = Enum.Font.SourceSansBold
	title.TextSize = 22
	title.TextColor3 = Color3.fromRGB(255, 255, 255)
	title.TextXAlignment = Enum.TextXAlignment.Left
	title.Parent = main

	local function makeToggle(name, y, state)
		local btn = Instance.new("TextButton")
		btn.Name = name.."Btn"
		btn.Size = UDim2.new(1, -12, 0, 36)
		btn.Position = UDim2.new(0, 6, 0, y)
		btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
		btn.TextColor3 = Color3.fromRGB(255, 255, 255)
		btn.Font = Enum.Font.SourceSans
		btn.TextSize = 18
		btn.Text = name .. ": ".. (state and "ON" or "OFF")
		btn.Parent = main
		return btn
	end

	local flyBtn = makeToggle("Fly", 46, SavageHub.Fly)

	local function makeLabelAndButtons(labelTxt, y, getVal)
		local lbl = Instance.new("TextLabel")
		lbl.Name = labelTxt.."Lbl"
		lbl.Size = UDim2.new(0.5, -10, 0, 28)
		lbl.Position = UDim2.new(0, 6, 0, y)
		lbl.BackgroundTransparency = 1
		lbl.Text = labelTxt .. ": " .. tostring(getVal())
		lbl.Font = Enum.Font.SourceSans
		lbl.TextSize = 16
		lbl.TextColor3 = Color3.fromRGB(230,230,230)
		lbl.TextXAlignment = Enum.TextXAlignment.Left
		lbl.Parent = main

		local dec = Instance.new("TextButton")
		dec.Name = labelTxt.."Dec"
		dec.Size = UDim2.new(0.25, -6, 0, 28)
		dec.Position = UDim2.new(0.5, 0, 0, y)
		dec.BackgroundColor3 = Color3.fromRGB(70,70,70)
		dec.Text = "-"
		dec.Font = Enum.Font.SourceSansBold
		dec.TextSize = 20
		dec.TextColor3 = Color3.fromRGB(255,255,255)
		dec.Parent = main

		local inc = Instance.new("TextButton")
		inc.Name = labelTxt.."Inc"
		inc.Size = UDim2.new(0.25, -6, 0, 28)
		inc.Position = UDim2.new(0.75, 0, 0, y)
		inc.BackgroundColor3 = Color3.fromRGB(70,70,70)
		inc.Text = "+"
		inc.Font = Enum.Font.SourceSansBold
		inc.TextSize = 20
		inc.TextColor3 = Color3.fromRGB(255,255,255)
		inc.Parent = main

		return lbl, dec, inc
	end

	local walkLbl, walkDec, walkInc = makeLabelAndButtons("WalkSpeed", 90, function() return SavageHub.WalkSpeed end)
	local jumpLbl, jumpDec, jumpInc = makeLabelAndButtons("JumpPower", 128, function() return SavageHub.JumpPower end)

	local closeBtn = Instance.new("TextButton")
	closeBtn.Name = "Close"
	closeBtn.Size = UDim2.new(0, 36, 0, 28)
	closeBtn.Position = UDim2.new(1, -42, 0, 6)
	closeBtn.BackgroundColor3 = Color3.fromRGB(100,30,30)
	closeBtn.Text = "X"
	closeBtn.Font = Enum.Font.SourceSansBold
	closeBtn.TextSize = 18
	closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
	closeBtn.Parent = main

	-- Bind functionality
	flyBtn.MouseButton1Click:Connect(function()
		SavageHub.Fly = not SavageHub.Fly
		flyBtn.Text = "Fly: " .. (SavageHub.Fly and "ON" or "OFF")
		if not SavageHub.Fly then
			-- restore humanoid behavior
			if humanoid and humanoid.Parent then
				pcall(function() humanoid.PlatformStand = false end)
			end
		end
	end)

	walkDec.MouseButton1Click:Connect(function()
		SavageHub.WalkSpeed = math.max(0, SavageHub.WalkSpeed - 4)
		walkLbl.Text = "WalkSpeed: " .. tostring(SavageHub.WalkSpeed)
		if humanoid and humanoid.Parent and not SavageHub.Fly then
			humanoid.WalkSpeed = SavageHub.WalkSpeed
		end
	end)
	walkInc.MouseButton1Click:Connect(function()
		SavageHub.WalkSpeed = math.min(500, SavageHub.WalkSpeed + 4)
		walkLbl.Text = "WalkSpeed: " .. tostring(SavageHub.WalkSpeed)
		if humanoid and humanoid.Parent and not SavageHub.Fly then
			humanoid.WalkSpeed = SavageHub.WalkSpeed
		end
	end)

	jumpDec.MouseButton1Click:Connect(function()
		SavageHub.JumpPower = math.max(0, SavageHub.JumpPower - 10)
		jumpLbl.Text = "JumpPower: " .. tostring(SavageHub.JumpPower)
		if humanoid and humanoid.Parent then
			humanoid.JumpPower = SavageHub.JumpPower
		end
	end)
	jumpInc.MouseButton1Click:Connect(function()
		SavageHub.JumpPower = math.min(500, SavageHub.JumpPower + 10)
		jumpLbl.Text = "JumpPower: " .. tostring(SavageHub.JumpPower)
		if humanoid and humanoid.Parent then
			humanoid.JumpPower = SavageHub.JumpPower
		end
	end)

	closeBtn.MouseButton1Click:Connect(function()
		SavageHub.MenuVisible = not SavageHub.MenuVisible
		main.Visible = SavageHub.MenuVisible
	end)

	-- toggle menu with key
	UserInputService.InputBegan:Connect(function(input, gameProcessed)
		if gameProcessed then return end
		if input.KeyCode == SavageHub.ToggleKey then
			SavageHub.MenuVisible = not SavageHub.MenuVisible
			main.Visible = SavageHub.MenuVisible
		end
	end)

	return screenGui, {flyBtn = flyBtn, walkLbl = walkLbl, jumpLbl = jumpLbl}
end

local gui, widgets = createUI()

-- Keep humanoid values in sync
local function applyHumanoidSettings()
	if humanoid and humanoid.Parent then
		if not SavageHub.Fly then
			humanoid.WalkSpeed = SavageHub.WalkSpeed
			humanoid.JumpPower = SavageHub.JumpPower
		else
			-- while flying we disable normal walk/jump physics
			pcall(function() humanoid.PlatformStand = true end)
		end
	end
end

-- Fly implementation (client-side control). Use only in places you own.
local flying = false
local flyConnection

local function startFly()
	if flying then return end
	flying = true
	-- ensure PlatformStand so Humanoid physics don't fight us
	pcall(function() humanoid.PlatformStand = true end)

	flyConnection = RunService.RenderStepped:Connect(function(dt)
		if not SavageHub.Fly then return end
		-- re-acquire camera/character in case of respawn
		char = getCharacter()
		humanoid = char and char:FindFirstChild("Humanoid") or humanoid
		hrp = char and char:FindFirstChild("HumanoidRootPart") or hrp
		camera = workspace.CurrentCamera

		if not hrp or not camera then return end

		local moveVec = Vector3.new()
		local camCFrame = camera.CFrame
		local forward = Vector3.new(camCFrame.LookVector.X, 0, camCFrame.LookVector.Z).Unit
		local right = Vector3.new(camCFrame.RightVector.X, 0, camCFrame.RightVector.Z).Unit

		if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveVec = moveVec + forward end
		if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveVec = moveVec - forward end
		if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveVec = moveVec - right end
		if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveVec = moveVec + right end
		-- ascend / descend
		if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveVec = moveVec + Vector3.new(0,1,0) end
		if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) or UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveVec = moveVec - Vector3.new(0,1,0) end

		local mag = moveVec.Magnitude
		if mag > 0 then
			moveVec = moveVec.Unit * SavageHub.FlySpeed
			-- smooth movement: set velocity
			hrp.Velocity = moveVec
		else
			-- small damping to stop
			hrp.Velocity = Vector3.new(0, 0, 0)
		end
	end)
end

local function stopFly()
	if not flying then return end
	flying = false
	if flyConnection then
		flyConnection:Disconnect()
		flyConnection = nil
	end
	-- restore normal physics
	pcall(function()
		if humanoid and humanoid.Parent then
			humanoid.PlatformStand = false
			humanoid.WalkSpeed = SavageHub.WalkSpeed
			humanoid.JumpPower = SavageHub.JumpPower
		end
	end)
end

-- Monitor the Fly toggle and apply behavior
RunService.Heartbeat:Connect(function()
	if SavageHub.Fly then
		startFly()
	else
		stopFly()
	end
	applyHumanoidSettings()
end)

-- Handle character respawn
player.CharacterAdded:Connect(function(c)
	char = c
	humanoid = char:WaitForChild("Humanoid")
	hrp = char:WaitForChild("HumanoidRootPart")
	-- reapply settings on spawn
	wait(0.1)
	applyHumanoidSettings()
end)

-- Initial apply
applyHumanoidSettings()

-- Friendly notice for the player (optional)
StarterGui:SetCore("SendNotification", {
	Title = "Savage Hub";
	Text = "Savage Hub loaded. Press RightShift to toggle menu. Use only in places you own.";
	Duration = 6;
})